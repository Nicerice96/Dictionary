#Zarif Khan 101224172
#Aiden Hepburn 101220580
#Chen Chen 101235800
#Ben MetCalfe 101234641

import T087_P1_load_data

book_dictionary = T087_P1_load_data.book_category_dictionary(r"C:\Users\Zarif\Downloads\google_books_dataset_THEGOODONE.csv")


#Functions 1 - sort_books_title - Zarif Khan 101224172
def sort_books_title(dictionary : dict) -> list:
    """This fucntion will sort the books based on the titles in alphabetical order
    
    >>>sort_books_author(book_dictionary)
    
    
    [{'title': 'Business Strategy (The Brian Tracy Success Library)', 'author': 'Brian Tracy', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics', 'Business'], 'pages': '112'}, {'title': 'Management (The Brian Tracy Success Library)', 'author': 'Brian Tracy', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics', 'Biography', 'Management'], 'pages': '112'}, {'title': 'Marketing (The Brian Tracy Success Library)', 'author': 'Brian Tracy', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics'], 'pages': '112'}, {'title': 'Personal Success (The Brian Tracy Success Library)', 'author': 'Brian Tracy', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics', 'Business'], 'pages': '112'}, {'title': 'The Essentials of Finance and Accounting for Nonfinancial Managers', 'author': 'Edward Fields', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics', 'Money Management', 'Business'], 'pages': '320'}, {'title': 'Mrs. Pollifax Unveiled', 'author': 'Dorothy Gilman', 'language': None, 'rating': '3.9', 'publisher': 'Ballantine Books', 'category': ['Fiction', 'Detective'], 'pages': '208'}, {'title': 'Eat That Frog!: 21 Great Ways to Stop Procrastinating and Get More Done in Less Time. Edition 3', 'author': 'Brian Tracy', 'language': None, 'rating': '4.7', 'publisher': 'Berrett-Koehler Publishers', 'category': ['Economics', 'Business'], 'pages': '144'}, {'title': 'Goals!: How to Get Everything You Want -- Faster Than You Ever Thought Possible. Edition 2', 'author': 'Brian Tracy', 'language': None, 'rating': '4.3', 'publisher': 'Berrett-Koehler Publishers', 'category': ['Economics'], 'pages': '288'}, {'title': 'A Trace of Crime (a Keri Locke Mystery Book #4)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.7', 'publisher': 'Blake Pierce', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '250'}, {'title': 'A Trace of Vice (a Keri Locke Mystery Book #3)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.8', 'publisher': 'Blake Pierce', 'category': ['Fiction'], 'pages': '250'}, {'title': 'Homecoming (A Chloe Fine Psychological Suspense Mystery Book 5)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.6', 'publisher': 'Blake Pierce', 'category': ['Detective', 'Mystery'], 'pages': '250'}, {'title': 'Once Missed (A Riley Paige Mystery Book 16)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.4', 'publisher': 'Blake Pierce', 'category': ['Thrillers', 'Detective', 'Mystery'], 'pages': '250'}, {'title': 'Riley Paige Mystery Bundle: Once Gone (#1) and Once Taken (#2)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.5', 'publisher': 'Blake Pierce', 'category': ['Economics', 'Thrillers', 'Detective', 'Mystery'], 'pages': '250'}, {'title': 'Watching (The Making of Riley Paige Book 1)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.6', 'publisher': 'Blake Pierce', 'category': ['Management', 'Detective', 'Mystery'], 'pages': '250'}, {'title': 'Becoming Steve Jobs: The Evolution of a Reckless Upstart into a Visionary Leader', 'author': 'Brent Schlender', 'language': None, 'rating': '4.6', 'publisher': 'Crown Business', 'category': ['Biography', 'Information Technology', 'Business'], 'pages': '464'}, {'title': 'Rework', 'author': 'Jason Fried', 'language': None, 'rating': '4.1', 'publisher': 'Currency', 'category': ['Economics', 'Business'], 'pages': '288'}, {'title': 'The Joker', 'author': 'Brian Azzarello', 'language': None, 'rating': '4.4', 'publisher': 'DC', 'category': ['Comics'], 'pages': '130'}, {'title': 'Young Justice Vol. 1', 'author': 'Art Baltazar', 'language': None, 'rating': '4.1', 'publisher': 'DC', 'category': ['Comics', 'Superheroes'], 'pages': '164'}, {'title': 'Watchmen (2019 Edition)', 'author': 'Alan Moore', 'language': None, 'rating': '4.2', 'publisher': 'DC Comics', 'category': ['Comics', 'Business', 'Superheroes'], 'pages': '448'}, {'title': "'Salem's Lot", 'author': 'Stephen King', 'language': None, 'rating': '4.4', 'publisher': 'Hachette UK', 'category': ['Thrillers', 'Fiction'], 'pages': '300'}, {'title': 'No Mercy: The brand new novel from the Queen of Crime', 'author': 'Martina Cole', 'language': None, 'rating': 'N/A', 'publisher': 'Hachette UK', 'category': ['Thrillers', 'Fiction'], 'pages': '416'}, {'title': 'Shantaram', 'author': 'Gregory David Roberts', 'language': None, 'rating': '4.5', 'publisher': 'Hachette UK', 'category': ['Thrillers', 'Fiction', 'Detective'], 'pages': '944'}, {'title': 'Sword of Destiny: Witcher 2: Tales of the Witcher', 'author': 'Andrzej Sapkowski', 'language': None, 'rating': '4.8', 'publisher': 'Hachette UK', 'category': ['Adventure', 'Mythical Creatures', 'Fiction'], 'pages': '400'}, {'title': 'Tall Tales and Wee Stories: The Best of Billy Connolly', 'author': 'Billy Connolly', 'language': None, 'rating': '5', 'publisher': 'Hachette UK', 'category': ['Economics', 'Biography', 'Humor'], 'pages': '336'}, {'title': 'The Black Box', 'author': 'Michael Connelly', 'language': None, 'rating': '4', 'publisher': 'Hachette UK', 'category': ['Thrillers', 'Fiction', 'Crime', 'Mystery'], 'pages': '448'}, {'title': 'The Guardians: The explosive new thriller from international bestseller John Grisham', 'author': 'John Grisham', 'language': None, 'rating': 'N/A', 'publisher': 'Hachette UK', 'category': ['Economics', 'Thrillers', 'Fiction', 'Legal'], 'pages': '384'}, {'title': 'The Malady and Other Stories: An Andrzej Sapkowski Sampler', 'author': 'Andrzej Sapkowski', 'language': None, 'rating': '4.8', 'publisher': 'Hachette UK', 'category': ['Adventure', 'Fiction', 'Fantasy'], 'pages': '96'}, {'title': 'The Name of the Wind: The Kingkiller Chronicle:Book 1', 'author': 'Patrick Rothfuss', 'language': None, 'rating': '4.3', 'publisher': 'Hachette UK', 'category': ['Fiction', 'Fantasy'], 'pages': '672'}, {'title': 'The Secrets of Saving and Investing with Alvin Hall: Simple Strategies to Make Your Money Go Further', 'author': 'Alvin Hall', 'language': None, 'rating': '3.7', 'publisher': 'Hachette UK', 'category': ['Finance', 'Business', 'Economics', 'Money Management', 'Thrillers', 'Investing'], 'pages': '30'}, {'title': 'The Tower of the Swallow: Witcher 6', 'author': 'Andrzej Sapkowski', 'language': None, 'rating': '4.6', 'publisher': 'Hachette UK', 'category': ['Epic', 'Fiction', 'Fantasy'], 'pages': '400'}, {'title': 'The Way Of Shadows: Book 1 of the Night Angel', 'author': 'Brent Weeks', 'language': None, 'rating': '4.7', 'publisher': 'Hachette UK', 'category': ['Adventure', 'Epic', 'Fantasy'], 'pages': '688'}, {'title': 'Freakonomics Rev Ed: A Rogue Economist Explores the Hidden Side of Everything', 'author': 'Steven D. Levitt', 'language': None, 'rating': '3.8', 'publisher': 'Harper Collins', 'category': ['Economics', 'Social Science', 'Business'], 'pages': '336'}, {'title': 'Little Girl Lost: A Lucy Black Thriller', 'author': 'Brian McGilloway', 'language': None, 'rating': '4', 'publisher': 'Harper Collins', 'category': ['Economics', 'Thrillers', 'Fiction', 'Mystery'], 'pages': '336'}, {'title': 'Secrets of the Millionaire Mind: Mastering the Inner Game of Wealth', 'author': 'T. Harv Eker', 'language': None, 'rating': '4.6', 'publisher': 'Harper Collins', 'category': ['Economics', 'Business'], 'pages': '224'}, {'title': 'Think Like a Freak: The Authors of Freakonomics Offer to Retrain Your Brain', 'author': 'Steven D. Levitt', 'language': None, 'rating': '4.3', 'publisher': 'Harper Collins', 'category': ['Business'], 'pages': '304'}, {'title': 'Platform: Get Noticed in a Noisy World', 'author': 'Michael Hyatt', 'language': None, 'rating': '4.6', 'publisher': 'HarperCollins Leadership', 'category': ['Economics', 'Business'], 'pages': '288'}, {'title': 'Selling 101: What Every Successful Sales Professional Needs to Know', 'author': 'Zig Ziglar', 'language': None, 'rating': '3.8', 'publisher': 'HarperCollins Leadership', 'category': ['Business'], 'pages': '112'}, {'title': 'A Feast for Crows (A Song of Ice and Fire. Book 4)', 'author': 'George R.R. Martin', 'language': None, 'rating': '4.5', 'publisher': 'HarperCollins UK', 'category': ['Adventure', 'Epic', 'Fiction', 'Fantasy'], 'pages': '864'}, {'title': 'A Game of Thrones: The Story Continues Books 1-5: A Game of Thrones. A Clash of Kings. A Storm of Swords. A Feast for Crows. A Dance with Dragons (A Song of Ice and Fire)', 'author': 'George R.R. Martin', 'language': None, 'rating': '4.5', 'publisher': 'HarperCollins UK', 'category': ['Epic', 'Economics', 'Fiction', 'Adventure', 'Fantasy'], 'pages': '4544'}, {'title': 'After Anna', 'author': 'Alex Lake', 'language': None, 'rating': '4.1', 'publisher': 'HarperCollins UK', 'category': ['Adventure', 'Thrillers', 'Fiction', 'Mystery'], 'pages': '416'}, {'title': 'And Then There Were None', 'author': 'Agatha Christie', 'language': None, 'rating': '4.6', 'publisher': 'HarperCollins UK', 'category': ['Thrillers', 'Fiction', 'Detective', 'Mystery'], 'pages': '224'}, {'title': 'Bring Me Back', 'author': 'B A Paris', 'language': None, 'rating': '3.8', 'publisher': 'HarperCollins UK', 'category': ['Thrillers', 'Fiction', 'Crime'], 'pages': '368'}, {'title': 'Predictably Irrational: The Hidden Forces that Shape Our Decisions', 'author': 'Dan Ariely', 'language': None, 'rating': '4', 'publisher': 'HarperCollins UK', 'category': ['Economics', 'Psychology', 'Business'], 'pages': '304'}, {'title': 'Prince of Thorns (The Broken Empire. Book 1)', 'author': 'Mark Lawrence', 'language': None, 'rating': '4.2', 'publisher': 'HarperCollins UK', 'category': ['Fiction', 'Fantasy'], 'pages': '416'}, {'title': 'The Lord of the Rings: The Fellowship of the Ring. The Two Towers. The Return of the King', 'author': 'J. R. R. Tolkien', 'language': None, 'rating': '4.6', 'publisher': 'HarperCollins UK', 'category': ['Fiction', 'Fantasy'], 'pages': '1216'}, {'title': 'The Mysterious Affair at Styles', 'author': 'Agatha Christie', 'language': None, 'rating': '4.4', 'publisher': 'HarperCollins UK', 'category': ['Horror', 'Fiction', 'Classics', 'Thrillers', 'Detective'], 'pages': '208'}, {'title': 'The Painted Man (The Demon Cycle. Book 1)', 'author': 'Peter V. Brett', 'language': None, 'rating': '4.5', 'publisher': 'HarperCollins UK', 'category': ['Thrillers', 'Fiction', 'Fantasy', 'Business'], 'pages': '544'}, {'title': 'The Red Signal: An Agatha Christie Short Story', 'author': 'Agatha Christie', 'language': None, 'rating': '5', 'publisher': 'HarperCollins UK', 'category': ['Traditional', 'Fiction', 'Detective', 'Mystery'], 'pages': '40'}, {'title': 'The Vagrant (The Vagrant Trilogy)', 'author': 'Peter Newman', 'language': None, 'rating': '4.2', 'publisher': 'HarperCollins UK', 'category': ['Fiction', 'Fantasy'], 'pages': '416'}, {'title': 'Antiques Chop', 'author': 'Barbara Allan', 'language': None, 'rating': '4.5', 'publisher': 'Kensington Books', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '240'}, {'title': 'Antiques Con', 'author': 'Barbara Allan', 'language': None, 'rating': '4.8', 'publisher': 'Kensington Books', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '288'}, {'title': 'Killer Blonde', 'author': 'Laura Levine', 'language': None, 'rating': '4', 'publisher': 'Kensington Books', 'category': ['Fiction', 'Detective'], 'pages': '288'}, {'title': 'Antiques Knock-Off', 'author': 'Barbara Allan', 'language': None, 'rating': '4.3', 'publisher': 'Kensington Publishing Corp.', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '240'}, {'title': "Antiques Roadkill: A Trash 'n' Treasures Mystery", 'author': 'Barbara Allan', 'language': None, 'rating': '3.3', 'publisher': 'Kensington Publishing Corp.', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '288'}, {'title': 'How to Understand Business Finance: Edition 2', 'author': 'Bob Cinnamon', 'language': None, 'rating': '3.5', 'publisher': 'Kogan Page Publishers', 'category': ['Economics', 'Business'], 'pages': '176'}, {'title': "Chronicle of the Unhewn Throne: (The Emperor's Blades. The Providence of Fire. The Last Mortal Bond)", 'author': 'Brian Staveley', 'language': None, 'rating': '4.3', 'publisher': 'Macmillan', 'category': ['Fiction', 'Fantasy'], 'pages': '1728'}, {'title': 'Deadpool Kills the Marvel Universe', 'author': 'Cullen Bunn', 'language': None, 'rating': '4.2', 'publisher': 'Marvel Entertainment', 'category': ['Comics'], 'pages': '96'}, {'title': 'Immortal Hulk Vol. 1: Or Is He Both?', 'author': 'Al Ewing', 'language': None, 'rating': '4.4', 'publisher': 'Marvel Entertainment', 'category': ['Comics', 'Superheroes'], 'pages': '128'}, {'title': 'Spider-Man: Anti-Venom', 'author': 'Dan Slott', 'language': None, 'rating': '4', 'publisher': 'Marvel Entertainment', 'category': ['Superheroes'], 'pages': '96'}, {'title': 'Spider-Verse: Volume 1', 'author': 'Dan Slott', 'language': None, 'rating': '4.4', 'publisher': 'Marvel Entertainment', 'category': ['Superheroes'], 'pages': '624'}, {'title': 'Ultimate Spider-Man Vol. 11: Carnage', 'author': 'Brian Michael Bendis', 'language': None, 'rating': '4.1', 'publisher': 'Marvel Entertainment', 'category': ['Comics'], 'pages': '144'}, {'title': 'Venomized', 'author': 'Cullen Bunn', 'language': None, 'rating': '4.5', 'publisher': 'Marvel Entertainment', 'category': ['Comics'], 'pages': '136'}, {'title': 'Permanent Record', 'author': 'Edward Snowden', 'language': None, 'rating': '4.6', 'publisher': 'Metropolitan Books', 'category': ['Legal', 'Biography'], 'pages': '352'}, {'title': 'In Dark Company: A Kate Burkholder Short Story', 'author': 'Linda Castillo', 'language': None, 'rating': '4.3', 'publisher': 'Minotaur Books', 'category': ['Thrillers', 'Fiction'], 'pages': '60'}, {'title': 'Night of the Bold (Kings and Sorcerers Book 6)', 'author': 'Morgan Rice', 'language': None, 'rating': '4.3', 'publisher': 'Morgan Rice', 'category': ['Fiction', 'Fantasy'], 'pages': '250'}, {'title': 'The Weight of Honor (Kings and Sorcerers Book 3)', 'author': 'Morgan Rice', 'language': None, 'rating': '4.4', 'publisher': 'Morgan Rice', 'category': ['Fiction', 'Fantasy'], 'pages': '250'}, {'title': 'Summary: Think and Grow Rich', 'author': 'Nine99 Innovation Lab', 'language': None, 'rating': 'N/A', 'publisher': 'Nine99 Innovation Lab (OPC) Pvt Ltd', 'category': ['Economics', 'Business'], 'pages': '14'}, {'title': 'We', 'author': 'Yevgeny Zamyatin', 'language': None, 'rating': '4.3', 'publisher': 'Pan', 'category': ['Fiction', 'Fantasy'], 'pages': '226'}, {'title': 'Total Control', 'author': 'David Baldacci', 'language': None, 'rating': '4', 'publisher': 'Pan Macmillan', 'category': ['Thrillers', 'Fiction', 'Crime', 'Mystery'], 'pages': '624'}, {'title': 'Twas The Nightshift Before Christmas: Festive hospital diaries from the author of million-copy hit This is Going to Hurt', 'author': 'Adam Kay', 'language': None, 'rating': '4.7', 'publisher': 'Pan Macmillan', 'category': ['Humor'], 'pages': '112'}, {'title': 'Boy Erased: A Memoir', 'author': 'Garrard Conley', 'language': None, 'rating': '4', 'publisher': 'Penguin', 'category': ['Economics', 'Biography'], 'pages': '352'}, {'title': 'Getting Things Done: The Art of Stress-Free Productivity', 'author': 'David Allen', 'language': None, 'rating': '4.5', 'publisher': 'Penguin', 'category': ['Economics'], 'pages': '352'}, {'title': 'No One Is Too Small to Make a Difference', 'author': 'Greta Thunberg', 'language': None, 'rating': '5', 'publisher': 'Penguin', 'category': ['Biography'], 'pages': '112'}, {'title': 'The Infinite Game', 'author': 'Simon Sinek', 'language': None, 'rating': '3.8', 'publisher': 'Penguin', 'category': ['Business'], 'pages': '272'}, {'title': 'The Magic of Thinking Big', 'author': 'David J. Schwartz', 'language': None, 'rating': '4.6', 'publisher': 'Penguin', 'category': ['Economics', 'Business'], 'pages': '256'}, {'title': "Final Option: 'The best one yet'", 'author': 'Clive Cussler', 'language': None, 'rating': '5', 'publisher': 'Penguin UK', 'category': ['Thrillers', 'Fiction', 'Crime', 'Mystery'], 'pages': '400'}, {'title': 'Happy: Why More or Less Everything is Absolutely Fine', 'author': 'Derren Brown', 'language': None, 'rating': '4', 'publisher': 'Random House', 'category': ['Social Science'], 'pages': '576'}, {'title': 'The Power of Habit: Why We Do What We Do in Life and Business', 'author': 'Charles Duhigg', 'language': None, 'rating': '4.1', 'publisher': 'Random House', 'category': ['Economics'], 'pages': '416'}, {'title': 'Financial Statements. Revised and Expanded Edition: A Step-by-Step Guide to Understanding and Creating Financial Reports', 'author': 'Thomas Ittelson', 'language': None, 'rating': '4', 'publisher': 'Red Wheel/Weiser', 'category': ['Economics'], 'pages': '288'}, {'title': 'How To Win Friends and Influence People', 'author': 'Dale Carnegie', 'language': None, 'rating': '4.3', 'publisher': 'Simon and Schuster', 'category': ['Economics', 'Psychology'], 'pages': '320'}, {'title': 'Principles: Life and Work', 'author': 'Ray Dalio', 'language': None, 'rating': '4.7', 'publisher': 'Simon and Schuster', 'category': ['Economics', 'Business'], 'pages': '592'}, {'title': 'Start Day Trading Now: A Quick and Easy Introduction to Making Money While Managing Your Risk', 'author': 'Michael Sincere', 'language': None, 'rating': '5', 'publisher': 'Simon and Schuster', 'category': ['Economics', 'Business'], 'pages': '224'}, {'title': 'The Memoirs of Sherlock Holmes', 'author': 'Arthur Conan Doyle', 'language': None, 'rating': '4.2', 'publisher': 'Simon and Schuster', 'category': ['Fiction', 'Classics', 'Mystery', 'Thrillers', 'Detective'], 'pages': '320'}, {'title': 'Edgedancer: From the Stormlight Archive', 'author': 'Brandon Sanderson', 'language': None, 'rating': '4.8', 'publisher': 'Tor Books', 'category': ['Adventure', 'Fiction'], 'pages': '226'}, {'title': 'Mistborn Trilogy: The Final Empire. The Well of Ascension. The Hero of Ages', 'author': 'Brandon Sanderson', 'language': None, 'rating': '4.7', 'publisher': 'Tor Books', 'category': ['Fantasy'], 'pages': '1712'}, {'title': 'We Should All Be Feminists', 'author': 'Chimamanda Ngozi Adichie', 'language': None, 'rating': '4.2', 'publisher': 'Vintage', 'category': ['Social Science'], 'pages': '32'}, {'title': "The Girl in the Spider's Web: A Lisbeth Salander novel: continuing Stieg Larsson's Millennium Series", 'author': 'David Lagercrantz', 'language': None, 'rating': '4.1', 'publisher': 'Vintage Crime/Black Lizard', 'category': ['Thrillers', 'Fiction', 'Mystery'], 'pages': '416'}, {'title': 'Platform Revolution: How Networked Markets Are Transforming the Economy and How to Make Them Work for You', 'author': 'Geoffrey G. Parker', 'language': None, 'rating': '4.5', 'publisher': 'W. W. Norton & Company', 'category': ['Business'], 'pages': '256'}]
    """


    
    lst = []
    
    for category in dictionary:
        for books in dictionary[category]:
            
            #Searching for duplicate titles
            same_title = False
            for book_info in lst:
                if book_info.get('title') == books.get('title'): 
                    same_title = True

            if not same_title:
                category = set()
                for matching_category in dictionary:
                    for matching_book in dictionary.get(matching_category):
                            if matching_book.get('title') == books.get('title'): 
                                category.add(matching_category) 
                                
                                
                #now formatted properly                      
                lst.append({
                    "title" : books.get('title'),
                    "author" : books.get('author'),
                    "language" : books.get('language '),
                    "rating" : books.get('rating'),
                    "publisher" : books.get('publisher'),
                    "category" : list(category),
                    "pages" : books.get('pages'),
                })       
                
    # Bubble Sort Algorithm 
    
    for i in range(len(lst)):
            for j in range(len(lst) - 1 - i):
                a = lst[j]
                b = lst[j + 1]
                        
                if a["publisher"] > b["publisher"]:
                    lst[j], lst[j+1] = lst[j + 1], lst[j]
                if a["publisher"] == b["publisher"]:
                    if a["title"] > b["title"]:
                        lst[j], lst[j+1] = lst[j + 1], lst[j]
        
    return lst


#Function 2 - sort_books_publisher - Aiden Hepburn 101220580
def sort_books_publisher(dictionary : dict) -> list:
    """This fucntion will sort the books based on the titles in alphabetical order
    
    >>>sort_books_author(book_dictionary)
    
    
    [{'title': 'Business Strategy (The Brian Tracy Success Library)', 'author': 'Brian Tracy', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics', 'Business'], 'pages': '112'}, {'title': 'Management (The Brian Tracy Success Library)', 'author': 'Brian Tracy', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics', 'Biography', 'Management'], 'pages': '112'}, {'title': 'Marketing (The Brian Tracy Success Library)', 'author': 'Brian Tracy', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics'], 'pages': '112'}, {'title': 'Personal Success (The Brian Tracy Success Library)', 'author': 'Brian Tracy', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics', 'Business'], 'pages': '112'}, {'title': 'The Essentials of Finance and Accounting for Nonfinancial Managers', 'author': 'Edward Fields', 'language': None, 'rating': 'N/A', 'publisher': 'AMACOM', 'category': ['Economics', 'Money Management', 'Business'], 'pages': '320'}, {'title': 'Mrs. Pollifax Unveiled', 'author': 'Dorothy Gilman', 'language': None, 'rating': '3.9', 'publisher': 'Ballantine Books', 'category': ['Fiction', 'Detective'], 'pages': '208'}, {'title': 'Eat That Frog!: 21 Great Ways to Stop Procrastinating and Get More Done in Less Time. Edition 3', 'author': 'Brian Tracy', 'language': None, 'rating': '4.7', 'publisher': 'Berrett-Koehler Publishers', 'category': ['Economics', 'Business'], 'pages': '144'}, {'title': 'Goals!: How to Get Everything You Want -- Faster Than You Ever Thought Possible. Edition 2', 'author': 'Brian Tracy', 'language': None, 'rating': '4.3', 'publisher': 'Berrett-Koehler Publishers', 'category': ['Economics'], 'pages': '288'}, {'title': 'A Trace of Crime (a Keri Locke Mystery Book #4)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.7', 'publisher': 'Blake Pierce', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '250'}, {'title': 'A Trace of Vice (a Keri Locke Mystery Book #3)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.8', 'publisher': 'Blake Pierce', 'category': ['Fiction'], 'pages': '250'}, {'title': 'Homecoming (A Chloe Fine Psychological Suspense Mystery Book 5)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.6', 'publisher': 'Blake Pierce', 'category': ['Detective', 'Mystery'], 'pages': '250'}, {'title': 'Once Missed (A Riley Paige Mystery Book 16)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.4', 'publisher': 'Blake Pierce', 'category': ['Thrillers', 'Detective', 'Mystery'], 'pages': '250'}, {'title': 'Riley Paige Mystery Bundle: Once Gone (#1) and Once Taken (#2)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.5', 'publisher': 'Blake Pierce', 'category': ['Economics', 'Thrillers', 'Detective', 'Mystery'], 'pages': '250'}, {'title': 'Watching (The Making of Riley Paige Book 1)', 'author': 'Blake Pierce', 'language': None, 'rating': '4.6', 'publisher': 'Blake Pierce', 'category': ['Management', 'Detective', 'Mystery'], 'pages': '250'}, {'title': 'Becoming Steve Jobs: The Evolution of a Reckless Upstart into a Visionary Leader', 'author': 'Brent Schlender', 'language': None, 'rating': '4.6', 'publisher': 'Crown Business', 'category': ['Biography', 'Information Technology', 'Business'], 'pages': '464'}, {'title': 'Rework', 'author': 'Jason Fried', 'language': None, 'rating': '4.1', 'publisher': 'Currency', 'category': ['Economics', 'Business'], 'pages': '288'}, {'title': 'The Joker', 'author': 'Brian Azzarello', 'language': None, 'rating': '4.4', 'publisher': 'DC', 'category': ['Comics'], 'pages': '130'}, {'title': 'Young Justice Vol. 1', 'author': 'Art Baltazar', 'language': None, 'rating': '4.1', 'publisher': 'DC', 'category': ['Comics', 'Superheroes'], 'pages': '164'}, {'title': 'Watchmen (2019 Edition)', 'author': 'Alan Moore', 'language': None, 'rating': '4.2', 'publisher': 'DC Comics', 'category': ['Comics', 'Business', 'Superheroes'], 'pages': '448'}, {'title': "'Salem's Lot", 'author': 'Stephen King', 'language': None, 'rating': '4.4', 'publisher': 'Hachette UK', 'category': ['Thrillers', 'Fiction'], 'pages': '300'}, {'title': 'No Mercy: The brand new novel from the Queen of Crime', 'author': 'Martina Cole', 'language': None, 'rating': 'N/A', 'publisher': 'Hachette UK', 'category': ['Thrillers', 'Fiction'], 'pages': '416'}, {'title': 'Shantaram', 'author': 'Gregory David Roberts', 'language': None, 'rating': '4.5', 'publisher': 'Hachette UK', 'category': ['Thrillers', 'Fiction', 'Detective'], 'pages': '944'}, {'title': 'Sword of Destiny: Witcher 2: Tales of the Witcher', 'author': 'Andrzej Sapkowski', 'language': None, 'rating': '4.8', 'publisher': 'Hachette UK', 'category': ['Adventure', 'Mythical Creatures', 'Fiction'], 'pages': '400'}, {'title': 'Tall Tales and Wee Stories: The Best of Billy Connolly', 'author': 'Billy Connolly', 'language': None, 'rating': '5', 'publisher': 'Hachette UK', 'category': ['Economics', 'Biography', 'Humor'], 'pages': '336'}, {'title': 'The Black Box', 'author': 'Michael Connelly', 'language': None, 'rating': '4', 'publisher': 'Hachette UK', 'category': ['Thrillers', 'Fiction', 'Crime', 'Mystery'], 'pages': '448'}, {'title': 'The Guardians: The explosive new thriller from international bestseller John Grisham', 'author': 'John Grisham', 'language': None, 'rating': 'N/A', 'publisher': 'Hachette UK', 'category': ['Economics', 'Thrillers', 'Fiction', 'Legal'], 'pages': '384'}, {'title': 'The Malady and Other Stories: An Andrzej Sapkowski Sampler', 'author': 'Andrzej Sapkowski', 'language': None, 'rating': '4.8', 'publisher': 'Hachette UK', 'category': ['Adventure', 'Fiction', 'Fantasy'], 'pages': '96'}, {'title': 'The Name of the Wind: The Kingkiller Chronicle:Book 1', 'author': 'Patrick Rothfuss', 'language': None, 'rating': '4.3', 'publisher': 'Hachette UK', 'category': ['Fiction', 'Fantasy'], 'pages': '672'}, {'title': 'The Secrets of Saving and Investing with Alvin Hall: Simple Strategies to Make Your Money Go Further', 'author': 'Alvin Hall', 'language': None, 'rating': '3.7', 'publisher': 'Hachette UK', 'category': ['Finance', 'Business', 'Economics', 'Money Management', 'Thrillers', 'Investing'], 'pages': '30'}, {'title': 'The Tower of the Swallow: Witcher 6', 'author': 'Andrzej Sapkowski', 'language': None, 'rating': '4.6', 'publisher': 'Hachette UK', 'category': ['Epic', 'Fiction', 'Fantasy'], 'pages': '400'}, {'title': 'The Way Of Shadows: Book 1 of the Night Angel', 'author': 'Brent Weeks', 'language': None, 'rating': '4.7', 'publisher': 'Hachette UK', 'category': ['Adventure', 'Epic', 'Fantasy'], 'pages': '688'}, {'title': 'Freakonomics Rev Ed: A Rogue Economist Explores the Hidden Side of Everything', 'author': 'Steven D. Levitt', 'language': None, 'rating': '3.8', 'publisher': 'Harper Collins', 'category': ['Economics', 'Social Science', 'Business'], 'pages': '336'}, {'title': 'Little Girl Lost: A Lucy Black Thriller', 'author': 'Brian McGilloway', 'language': None, 'rating': '4', 'publisher': 'Harper Collins', 'category': ['Economics', 'Thrillers', 'Fiction', 'Mystery'], 'pages': '336'}, {'title': 'Secrets of the Millionaire Mind: Mastering the Inner Game of Wealth', 'author': 'T. Harv Eker', 'language': None, 'rating': '4.6', 'publisher': 'Harper Collins', 'category': ['Economics', 'Business'], 'pages': '224'}, {'title': 'Think Like a Freak: The Authors of Freakonomics Offer to Retrain Your Brain', 'author': 'Steven D. Levitt', 'language': None, 'rating': '4.3', 'publisher': 'Harper Collins', 'category': ['Business'], 'pages': '304'}, {'title': 'Platform: Get Noticed in a Noisy World', 'author': 'Michael Hyatt', 'language': None, 'rating': '4.6', 'publisher': 'HarperCollins Leadership', 'category': ['Economics', 'Business'], 'pages': '288'}, {'title': 'Selling 101: What Every Successful Sales Professional Needs to Know', 'author': 'Zig Ziglar', 'language': None, 'rating': '3.8', 'publisher': 'HarperCollins Leadership', 'category': ['Business'], 'pages': '112'}, {'title': 'A Feast for Crows (A Song of Ice and Fire. Book 4)', 'author': 'George R.R. Martin', 'language': None, 'rating': '4.5', 'publisher': 'HarperCollins UK', 'category': ['Adventure', 'Epic', 'Fiction', 'Fantasy'], 'pages': '864'}, {'title': 'A Game of Thrones: The Story Continues Books 1-5: A Game of Thrones. A Clash of Kings. A Storm of Swords. A Feast for Crows. A Dance with Dragons (A Song of Ice and Fire)', 'author': 'George R.R. Martin', 'language': None, 'rating': '4.5', 'publisher': 'HarperCollins UK', 'category': ['Epic', 'Economics', 'Fiction', 'Adventure', 'Fantasy'], 'pages': '4544'}, {'title': 'After Anna', 'author': 'Alex Lake', 'language': None, 'rating': '4.1', 'publisher': 'HarperCollins UK', 'category': ['Adventure', 'Thrillers', 'Fiction', 'Mystery'], 'pages': '416'}, {'title': 'And Then There Were None', 'author': 'Agatha Christie', 'language': None, 'rating': '4.6', 'publisher': 'HarperCollins UK', 'category': ['Thrillers', 'Fiction', 'Detective', 'Mystery'], 'pages': '224'}, {'title': 'Bring Me Back', 'author': 'B A Paris', 'language': None, 'rating': '3.8', 'publisher': 'HarperCollins UK', 'category': ['Thrillers', 'Fiction', 'Crime'], 'pages': '368'}, {'title': 'Predictably Irrational: The Hidden Forces that Shape Our Decisions', 'author': 'Dan Ariely', 'language': None, 'rating': '4', 'publisher': 'HarperCollins UK', 'category': ['Economics', 'Psychology', 'Business'], 'pages': '304'}, {'title': 'Prince of Thorns (The Broken Empire. Book 1)', 'author': 'Mark Lawrence', 'language': None, 'rating': '4.2', 'publisher': 'HarperCollins UK', 'category': ['Fiction', 'Fantasy'], 'pages': '416'}, {'title': 'The Lord of the Rings: The Fellowship of the Ring. The Two Towers. The Return of the King', 'author': 'J. R. R. Tolkien', 'language': None, 'rating': '4.6', 'publisher': 'HarperCollins UK', 'category': ['Fiction', 'Fantasy'], 'pages': '1216'}, {'title': 'The Mysterious Affair at Styles', 'author': 'Agatha Christie', 'language': None, 'rating': '4.4', 'publisher': 'HarperCollins UK', 'category': ['Horror', 'Fiction', 'Classics', 'Thrillers', 'Detective'], 'pages': '208'}, {'title': 'The Painted Man (The Demon Cycle. Book 1)', 'author': 'Peter V. Brett', 'language': None, 'rating': '4.5', 'publisher': 'HarperCollins UK', 'category': ['Thrillers', 'Fiction', 'Fantasy', 'Business'], 'pages': '544'}, {'title': 'The Red Signal: An Agatha Christie Short Story', 'author': 'Agatha Christie', 'language': None, 'rating': '5', 'publisher': 'HarperCollins UK', 'category': ['Traditional', 'Fiction', 'Detective', 'Mystery'], 'pages': '40'}, {'title': 'The Vagrant (The Vagrant Trilogy)', 'author': 'Peter Newman', 'language': None, 'rating': '4.2', 'publisher': 'HarperCollins UK', 'category': ['Fiction', 'Fantasy'], 'pages': '416'}, {'title': 'Antiques Chop', 'author': 'Barbara Allan', 'language': None, 'rating': '4.5', 'publisher': 'Kensington Books', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '240'}, {'title': 'Antiques Con', 'author': 'Barbara Allan', 'language': None, 'rating': '4.8', 'publisher': 'Kensington Books', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '288'}, {'title': 'Killer Blonde', 'author': 'Laura Levine', 'language': None, 'rating': '4', 'publisher': 'Kensington Books', 'category': ['Fiction', 'Detective'], 'pages': '288'}, {'title': 'Antiques Knock-Off', 'author': 'Barbara Allan', 'language': None, 'rating': '4.3', 'publisher': 'Kensington Publishing Corp.', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '240'}, {'title': "Antiques Roadkill: A Trash 'n' Treasures Mystery", 'author': 'Barbara Allan', 'language': None, 'rating': '3.3', 'publisher': 'Kensington Publishing Corp.', 'category': ['Fiction', 'Detective', 'Mystery'], 'pages': '288'}, {'title': 'How to Understand Business Finance: Edition 2', 'author': 'Bob Cinnamon', 'language': None, 'rating': '3.5', 'publisher': 'Kogan Page Publishers', 'category': ['Economics', 'Business'], 'pages': '176'}, {'title': "Chronicle of the Unhewn Throne: (The Emperor's Blades. The Providence of Fire. The Last Mortal Bond)", 'author': 'Brian Staveley', 'language': None, 'rating': '4.3', 'publisher': 'Macmillan', 'category': ['Fiction', 'Fantasy'], 'pages': '1728'}, {'title': 'Deadpool Kills the Marvel Universe', 'author': 'Cullen Bunn', 'language': None, 'rating': '4.2', 'publisher': 'Marvel Entertainment', 'category': ['Comics'], 'pages': '96'}, {'title': 'Immortal Hulk Vol. 1: Or Is He Both?', 'author': 'Al Ewing', 'language': None, 'rating': '4.4', 'publisher': 'Marvel Entertainment', 'category': ['Comics', 'Superheroes'], 'pages': '128'}, {'title': 'Spider-Man: Anti-Venom', 'author': 'Dan Slott', 'language': None, 'rating': '4', 'publisher': 'Marvel Entertainment', 'category': ['Superheroes'], 'pages': '96'}, {'title': 'Spider-Verse: Volume 1', 'author': 'Dan Slott', 'language': None, 'rating': '4.4', 'publisher': 'Marvel Entertainment', 'category': ['Superheroes'], 'pages': '624'}, {'title': 'Ultimate Spider-Man Vol. 11: Carnage', 'author': 'Brian Michael Bendis', 'language': None, 'rating': '4.1', 'publisher': 'Marvel Entertainment', 'category': ['Comics'], 'pages': '144'}, {'title': 'Venomized', 'author': 'Cullen Bunn', 'language': None, 'rating': '4.5', 'publisher': 'Marvel Entertainment', 'category': ['Comics'], 'pages': '136'}, {'title': 'Permanent Record', 'author': 'Edward Snowden', 'language': None, 'rating': '4.6', 'publisher': 'Metropolitan Books', 'category': ['Legal', 'Biography'], 'pages': '352'}, {'title': 'In Dark Company: A Kate Burkholder Short Story', 'author': 'Linda Castillo', 'language': None, 'rating': '4.3', 'publisher': 'Minotaur Books', 'category': ['Thrillers', 'Fiction'], 'pages': '60'}, {'title': 'Night of the Bold (Kings and Sorcerers Book 6)', 'author': 'Morgan Rice', 'language': None, 'rating': '4.3', 'publisher': 'Morgan Rice', 'category': ['Fiction', 'Fantasy'], 'pages': '250'}, {'title': 'The Weight of Honor (Kings and Sorcerers Book 3)', 'author': 'Morgan Rice', 'language': None, 'rating': '4.4', 'publisher': 'Morgan Rice', 'category': ['Fiction', 'Fantasy'], 'pages': '250'}, {'title': 'Summary: Think and Grow Rich', 'author': 'Nine99 Innovation Lab', 'language': None, 'rating': 'N/A', 'publisher': 'Nine99 Innovation Lab (OPC) Pvt Ltd', 'category': ['Economics', 'Business'], 'pages': '14'}, {'title': 'We', 'author': 'Yevgeny Zamyatin', 'language': None, 'rating': '4.3', 'publisher': 'Pan', 'category': ['Fiction', 'Fantasy'], 'pages': '226'}, {'title': 'Total Control', 'author': 'David Baldacci', 'language': None, 'rating': '4', 'publisher': 'Pan Macmillan', 'category': ['Thrillers', 'Fiction', 'Crime', 'Mystery'], 'pages': '624'}, {'title': 'Twas The Nightshift Before Christmas: Festive hospital diaries from the author of million-copy hit This is Going to Hurt', 'author': 'Adam Kay', 'language': None, 'rating': '4.7', 'publisher': 'Pan Macmillan', 'category': ['Humor'], 'pages': '112'}, {'title': 'Boy Erased: A Memoir', 'author': 'Garrard Conley', 'language': None, 'rating': '4', 'publisher': 'Penguin', 'category': ['Economics', 'Biography'], 'pages': '352'}, {'title': 'Getting Things Done: The Art of Stress-Free Productivity', 'author': 'David Allen', 'language': None, 'rating': '4.5', 'publisher': 'Penguin', 'category': ['Economics'], 'pages': '352'}, {'title': 'No One Is Too Small to Make a Difference', 'author': 'Greta Thunberg', 'language': None, 'rating': '5', 'publisher': 'Penguin', 'category': ['Biography'], 'pages': '112'}, {'title': 'The Infinite Game', 'author': 'Simon Sinek', 'language': None, 'rating': '3.8', 'publisher': 'Penguin', 'category': ['Business'], 'pages': '272'}, {'title': 'The Magic of Thinking Big', 'author': 'David J. Schwartz', 'language': None, 'rating': '4.6', 'publisher': 'Penguin', 'category': ['Economics', 'Business'], 'pages': '256'}, {'title': "Final Option: 'The best one yet'", 'author': 'Clive Cussler', 'language': None, 'rating': '5', 'publisher': 'Penguin UK', 'category': ['Thrillers', 'Fiction', 'Crime', 'Mystery'], 'pages': '400'}, {'title': 'Happy: Why More or Less Everything is Absolutely Fine', 'author': 'Derren Brown', 'language': None, 'rating': '4', 'publisher': 'Random House', 'category': ['Social Science'], 'pages': '576'}, {'title': 'The Power of Habit: Why We Do What We Do in Life and Business', 'author': 'Charles Duhigg', 'language': None, 'rating': '4.1', 'publisher': 'Random House', 'category': ['Economics'], 'pages': '416'}, {'title': 'Financial Statements. Revised and Expanded Edition: A Step-by-Step Guide to Understanding and Creating Financial Reports', 'author': 'Thomas Ittelson', 'language': None, 'rating': '4', 'publisher': 'Red Wheel/Weiser', 'category': ['Economics'], 'pages': '288'}, {'title': 'How To Win Friends and Influence People', 'author': 'Dale Carnegie', 'language': None, 'rating': '4.3', 'publisher': 'Simon and Schuster', 'category': ['Economics', 'Psychology'], 'pages': '320'}, {'title': 'Principles: Life and Work', 'author': 'Ray Dalio', 'language': None, 'rating': '4.7', 'publisher': 'Simon and Schuster', 'category': ['Economics', 'Business'], 'pages': '592'}, {'title': 'Start Day Trading Now: A Quick and Easy Introduction to Making Money While Managing Your Risk', 'author': 'Michael Sincere', 'language': None, 'rating': '5', 'publisher': 'Simon and Schuster', 'category': ['Economics', 'Business'], 'pages': '224'}, {'title': 'The Memoirs of Sherlock Holmes', 'author': 'Arthur Conan Doyle', 'language': None, 'rating': '4.2', 'publisher': 'Simon and Schuster', 'category': ['Fiction', 'Classics', 'Mystery', 'Thrillers', 'Detective'], 'pages': '320'}, {'title': 'Edgedancer: From the Stormlight Archive', 'author': 'Brandon Sanderson', 'language': None, 'rating': '4.8', 'publisher': 'Tor Books', 'category': ['Adventure', 'Fiction'], 'pages': '226'}, {'title': 'Mistborn Trilogy: The Final Empire. The Well of Ascension. The Hero of Ages', 'author': 'Brandon Sanderson', 'language': None, 'rating': '4.7', 'publisher': 'Tor Books', 'category': ['Fantasy'], 'pages': '1712'}, {'title': 'We Should All Be Feminists', 'author': 'Chimamanda Ngozi Adichie', 'language': None, 'rating': '4.2', 'publisher': 'Vintage', 'category': ['Social Science'], 'pages': '32'}, {'title': "The Girl in the Spider's Web: A Lisbeth Salander novel: continuing Stieg Larsson's Millennium Series", 'author': 'David Lagercrantz', 'language': None, 'rating': '4.1', 'publisher': 'Vintage Crime/Black Lizard', 'category': ['Thrillers', 'Fiction', 'Mystery'], 'pages': '416'}, {'title': 'Platform Revolution: How Networked Markets Are Transforming the Economy and How to Make Them Work for You', 'author': 'Geoffrey G. Parker', 'language': None, 'rating': '4.5', 'publisher': 'W. W. Norton & Company', 'category': ['Business'], 'pages': '256'}]
    """


    
    lst = []
    
    for category in dictionary:
        for books in dictionary[category]:
            
            #Searching for duplicate titles
            same_title = False
            for book_info in lst:
                if book_info.get('title') == books.get('title'): 
                    same_title = True

            if not same_title:
                category = set()
                for matching_category in dictionary:
                    for matching_book in dictionary.get(matching_category):
                            if matching_book.get('title') == books.get('title'): 
                                category.add(matching_category) 
                                
                                
                #now formatted properly                      
                lst.append({
                    "title" : books.get('title'),
                    "author" : books.get('author'),
                    "language" : books.get('language '),
                    "rating" : books.get('rating'),
                    "publisher" : books.get('publisher'),
                    "category" : list(category),
                    "pages" : books.get('pages'),
                })       
                
    # Bubble Sort Algorithm 
    
    for i in range(len(lst)):
            for j in range(len(lst) - 1 - i):
                a = lst[j]
                b = lst[j + 1]
                        
                if a["publisher"] > b["publisher"]:
                    lst[j], lst[j+1] = lst[j + 1], lst[j]
                if a["publisher"] == b["publisher"]:
                    if a["title"] > b["title"]:
                        lst[j], lst[j+1] = lst[j + 1], lst[j]
        
    return lst

#Function 3 - sort_books_author - Ben MetCalfe 101234641

def sort_books_author(dictionary : dict) -> list:
    
    empty_lst = []

    for categories in dictionary: #for all the dif categories associted with books
        for books in dictionary[categories]: #for all the books inj those categories
            same_book = False 
            for book_info in empty_lst: #for all the books in the list
                if book_info.get('title') == books.get('title'): #if the book in our list is the same as a book in a category
                    same_book = True #they are the same

            if not same_book: 
                categories = set() 
                for category in dictionary: #for categories in the dict
                    for same_book in dictionary.get(category): #get the categories from the book in our books
                            if same_book.get('title') == books.get('title'): #if they are the same
                                categories.add(category)   #put categories into a set
                empty_lst.append({"title" : books.get('title'),"author" : books.get('author'),"language" : books.get('language '),"rating" : books.get('rating'),"publisher" : books.get('publisher'),"category" : list(categories),"pages" : books.get('pages'),})       #and put categories into formating

    #Bubble Sort Algorithm 
    for i in range(len(empty_lst)):
            for j in range(len(empty_lst) - 1 - i):
                elim1 = empty_lst[j]
                elim2 = empty_lst[j + 1]

                if elim1["author"] > elim2["author"]:
                    empty_lst[j], empty_lst[j+1] = empty_lst[j + 1], empty_lst[j]

    return empty_lst
 
#Function 4 - sort_books_ascending_rate - Chen Chen 101235800

def sort_books_ascending_rate(book_lst: list) -> list:
    
    sort_book = []
    sort_book_combine_category = []
    category_number = 0
    none_rating = []
    
    for lst_category in list(book_lst.values()):
        for lst_category_book in lst_category:
            lst_category_book['category'] = [list(book_lst.keys())[category_number]]
            sort_book.append(lst_category_book)
        category_number += 1
        
    for i in range(len(sort_book)):
        for j in range(len(sort_book)-i-1):
            if sort_book[j].get('title') > sort_book[j+1].get('title'):
                sort_book[j],sort_book[j+1] = sort_book[j+1],sort_book[j]
                
    for i in range(1,len(sort_book)):
        if sort_book[j].get('title') == sort_book[i-1].get('title'):
            sort_book[i]['category'] += sort_book[i-1].get('category')
        else:
            sort_book_combine_category.append(sort_book[i-1])
    sort_book_combine_category.append(sort_book[-1])
    
    for i in range(len(sort_book_combine_category)):
        if sort_book_combine_category[i].get('rating')=='N/A':
            none_rating.append(sort_book_combine_category[i])

    for i in range(len(sort_book_combine_category)):
        for j in range(len(sort_book_combine_category)-i-1):
            a = sort_book_combine_category[j]
            b = sort_book_combine_category[j + 1]
            
            if a['rating']>b['rating']:
                sort_book_combine_category[j], sort_book_combine_category[j + 1] = sort_book_combine_category[j + 1], sort_book_combine_category[j]
            
                                       
    output = none_rating + sort_book_combine_category
                    
    return output

